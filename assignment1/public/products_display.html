<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Island Cycling</title>
    <link href="https://fonts.googleapis.com/css?family=Cherry+Swash%7CRaleway" rel="stylesheet">
    <link href="products-style.css" rel="stylesheet">
    <script src="./product_data.js"></script>
</head>

<form name="submit_form" action="./invoice.html" method="POST">

<body>

    <header>
        <h1>Island Cycling</h1>
    </header>

    <script>
        function isNonNegInt(queryString, returnErrors = false) {
            errors = []; // assume no errors at first
            if (Number(queryString) != queryString) {
                errors.push('Not a number!'); // Check if string is a number value
            } else {
                if (queryString < 0) errors.push('Negative value!'); // Check if it is non-negative
                if (parseInt(queryString) != queryString) errors.push('Not an integer!'); // Check that it is an integer
                if (queryString == 0 && queryString == '') errors.push('Enter valid quantity');
            }
            if (returnErrors) {
                return errors;
            } else if (errors.length == 0) {
                return true;
            } else {
                return false;
            }
        }        
        function checkQuantityTextbox(theTextbox) {
                errs = isNonNegInt(theTextbox.value, true);
                document.getElementById(theTextbox.name + '_message').innerHTML = errs.join(", ");
            }

        function display_purchase(quantityID) {
            let value = document.getElementById(quantityID).value;
        let validate = isNonNegInt(value);
        if (validate) {
            
        }}

    </script>

    <div>
        <main>
           <script>
           for(i = 0; i < products.length; i++) {
           document.write(`
            <section class="item">
                <h2>${products[i].name}</h2>
                <h4>Enter Quantities:</h4>
                <p>$${products[i].price}</p>
                <img src=./images/${products[i].image}>
                <h6>Left in Stock: ${products[i].qty_available}</h6>
                <label for="quantity_textbox">quantity desired:</label>
                <input class= "error_msg" type="text" name="quantity${i}" onkeyup="checkQuantityTextbox(this);">
                <span class= "textbox" id="quantity${i}_message">Enter a quantity</span>
            </section>
            `)
        };
        </script>

        </main>
    </div>
    <footer>
        <h1>
            The Source for the #1 Triathalon Equipement!
            <br>
            <input class="submit_button" type="submit" value="Purchase!">
        </h1>
    </footer>
</body>
</form>
<script>
                if (params.has('quantity')) { //makes the form "sticky"
            quantity_form["quantity"].value = params.get('quantity');
            checkQuantityTextbox(quantity_form["quantity"]);}
</script>
</html>